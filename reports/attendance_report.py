import pandas as pd


def build_attendance_report(df: pd.DataFrame) -> str:
    df = df[['–§–ò–û –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è', '–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å']].dropna()

    # –ü—Ä–∏–≤–æ–¥–∏–º –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å –∫ —á–∏—Å–ª—É
    df['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'] = (
        df['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å']
        .astype(str)
        .str.replace('%', '', regex=False)
        .str.replace(',', '.', regex=False)
    )

    df['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'] = pd.to_numeric(
        df['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'],
        errors='coerce'
    )

    # –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å
    df = df.dropna(subset=['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'])

    low_attendance = df[df['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å'] < 40]

    if low_attendance.empty:
        return "‚úÖ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å—é –Ω–∏–∂–µ 40% –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"

    result = "üö® *–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å –Ω–∏–∂–µ 40%*\n\n"
    for _, row in low_attendance.iterrows():
        result += f"‚Ä¢ {row['–§–ò–û –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è']} ‚Äî {row['–°—Ä–µ–¥–Ω—è—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å']}%\n"

    return result
